# Reddit Story Video Generator

Automatically creates TikTok/YouTube Shorts-style vertical videos from Reddit stories with word-synced subtitles, Edge TTS narration, and a Reddit-themed header card.

## Features

- **No API Keys Required** — Scrapes Reddit directly via JSON endpoints (no PRAW/config.py needed)
- **Word-Synced Subtitles** — Uses Edge TTS WordBoundary events for frame-accurate captions
- **Reddit-Style Header** — Modern card with logo, channel name, verified badge, engagement icons, drop shadow
- **Edge TTS Voice** — "Jenny Neural" TikTok-style narration
- **Smart Story Selection** — Filters by engagement ratio, word count (80-350), NSFW, and minimum score
- **Duplicate Prevention** — SQLite database tracks processed posts
- **9:16 Mobile Format** — 720x1280 optimized for YouTube Shorts / TikTok
- **Batch Processing** — Generate multiple videos at once

---

## Setup on a New Machine

### 1. Prerequisites

- **Python 3.10+** — Download from [python.org](https://www.python.org/downloads/)
  - During install, check "Add Python to PATH"
- **FFmpeg** — Required by MoviePy for video encoding
  - Download from [ffmpeg.org](https://ffmpeg.org/download.html) or install via:
    ```bash
    # Windows (with winget)
    winget install FFmpeg

    # Windows (with choco)
    choco install ffmpeg

    # macOS
    brew install ffmpeg

    # Linux
    sudo apt install ffmpeg
    ```
  - Make sure `ffmpeg` is on your PATH (run `ffmpeg -version` to check)
- **Git** — To clone the repo

### 2. Clone the Repository

```bash
git clone https://github.com/YOUR_USERNAME/reddit-story-video-generator.git
cd reddit-story-video-generator
```

### 3. Create a Virtual Environment

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

### 4. Install Dependencies

```bash
pip install -r requirements_webscraper.txt
```

This installs: requests, beautifulsoup4, gtts, edge-tts, pydub, moviepy, numpy, imageio, imageio-ffmpeg, Pillow.

### 5. Add Background Gameplay Videos

Create a `gameplay_videos/` folder (if it doesn't already exist) and put one or more `.mp4` files in it. These are used as the background footage behind the subtitles.

```
gameplay_videos/
  ├── minecraft_parkour.mp4
  ├── subway_surfers.mp4
  └── any_gameplay.mp4
```

The script picks a random segment from a random video each time.

### 6. Verify Folders Exist

Make sure these folders exist in the project root (create them if not):

```
output_videos/       <- Generated videos go here
gameplay_videos/     <- Your background .mp4 files
```

The script will also create `temp_audio/` automatically during processing.

### 7. Check Required Assets

The repo already includes these — just make sure they're present after cloning:

**Fonts** (`fonts/` folder):
```
fonts/
  ├── Montserrat-Black.ttf    <- Used for subtitles and header title
  └── Montserrat-Bold.ttf     <- Used for header text
```

**Logo Assets** (`logo/` folder):
```
logo/
  ├── Redit logo.png           <- Reddit logo for header
  ├── emijeys.png              <- Emoji reaction strip
  ├── harts&coments.png        <- Hearts/comments engagement icons
  ├── share.png                <- Share button icon
  └── verified.png             <- Verified badge icon
```

If any of these are missing, the header will still render but without those elements.

---

## Running the Generator

### Generate Videos (Main Script)

```bash
python main_webscraper.py
```

This will:
1. Scrape stories from the configured subreddit
2. Filter by engagement, word count, NSFW, and score
3. Generate Edge TTS audio with word-level timing
4. Render 720x1280 videos with header + synced subtitles
5. Save to `output_videos/`

### Preview the Header Only

```bash
python test_header.py
```

Outputs `header_preview.png` so you can check the header layout without rendering a full video.

---

## Configuration

Edit the bottom of `main_webscraper.py` to change these settings:

```python
subreddit = "AmItheAsshole"    # Which subreddit to scrape
num_videos = 2                 # How many videos to generate
```

Inside `scrape_reddit_stories()` call you can also set:
- `sort="hot"` — Sort mode: `"hot"`, `"top"`, or `"new"`
- `min_score=50` — Minimum upvotes required
- Stories are auto-filtered to 80-350 words and sorted by engagement ratio

### Change the TTS Voice

In `_generate_edge_tts_async()`, change the voice:
```python
voice = "en-US-JennyNeural"    # Default (TikTok-style female)
voice = "en-US-AriaNeural"     # Alternative female
voice = "en-US-GuyNeural"      # Male voice
```

---

## Project Structure

```
reddit-story-video-generator/
├── main_webscraper.py         # Main script (web scraping, no API needed)
├── main.py                    # Alternative version (uses Reddit API/PRAW)
├── header.py                  # Reddit-style header card generation
├── subtitles.py               # Word-by-word subtitle timing and rendering
├── test_header.py             # Quick header preview (outputs PNG)
├── requirements_webscraper.txt # Python dependencies
├── processed_posts.db         # SQLite DB tracking processed posts (auto-created)
├── fonts/                     # Montserrat font files
├── logo/                      # Header image assets
├── gameplay_videos/           # Your background .mp4 files (you provide)
├── output_videos/             # Generated videos (auto-created)
└── readme                     # This file
```

---

## Troubleshooting

### "No module named 'edge_tts'" or similar
```bash
pip install -r requirements_webscraper.txt
```

### "FFmpeg not found" / video encoding fails
Make sure FFmpeg is installed and on your PATH:
```bash
ffmpeg -version
```

### "No gameplay videos found"
Put at least one `.mp4` file in the `gameplay_videos/` folder.

### Subtitles are out of sync
Make sure you have `edge-tts>=6.1.0` installed. The script uses `boundary='WordBoundary'` which requires a recent version.

### Header assets missing
The header will still work without logo/emoji images — it just won't show those elements. Make sure the `logo/` and `fonts/` folders came through when you cloned.

### Out of memory errors
- Use shorter background videos (under 10 minutes)
- Reduce `num_videos` to process fewer at a time
- Close other applications while processing

### Reddit scraping returns no stories
- Check your internet connection
- Try a different subreddit
- Reddit may rate-limit requests — wait a minute and try again

---

## Popular Subreddits for Stories

- `AmItheAsshole` — Moral dilemmas
- `tifu` — "Today I F***ed Up"
- `EntitledPeople` — Karen stories
- `MaliciousCompliance` — Revenge stories
- `ProRevenge` — Epic revenge tales
- `offmychest` — Personal confessions
- `relationship_advice` — Dating/relationship issues

---

## Legal Notes

- **Reddit Content**: Public posts used for commentary
- **Background Videos**: Use your own gameplay or royalty-free footage
- **Edge TTS**: Free for personal use
- **Fonts**: Montserrat is licensed under OFL (Open Font License)
